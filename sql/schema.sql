DROP TABLE IF EXISTS DocumentLending;
DROP TABLE IF EXISTS Document;
DROP TABLE IF EXISTS AppUser;

CREATE TABLE AppUser (
	id SERIAL PRIMARY KEY,
	login_name VARCHAR(32) NOT NULL UNIQUE CHECK(LENGTH(TRIM(login_name)) > 0),
	password VARCHAR(32) NOT NULL CHECK(LENGTH(TRIM(password)) > 0),
	display_name VARCHAR(64) NOT NULL CHECK(LENGTH(TRIM(display_name)) > 0)
);

CREATE TABLE Document (
	id SERIAL PRIMARY KEY,
	name VARCHAR(100) NOT NULL CHECK(LENGTH(TRIM(name)) > 0),
	description BPCHAR,
	uploader_id INTEGER REFERENCES AppUser NOT NULL
);

CREATE TABLE DocumentLending (
	id SERIAL PRIMARY KEY,
	user_id INTEGER REFERENCES AppUser NOT NULL,
	document_id INTEGER REFERENCES Document NOT NULL
)